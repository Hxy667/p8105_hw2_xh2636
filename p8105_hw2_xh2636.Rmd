---
title: "p8105_hw2_xh2636"
author: "Xiaoyu Huang"
date: "2023-09-28"
output: html_document
---

## Problem 1
```{r}
library(tidyverse)
library(dplyr)
```

## P1-1st part
```{r}
pols_month_data = read_csv("./data/pols-month.csv")%>%
  janitor::clean_names()%>%
  separate(mon, into = c("year","month","day"),
           sep = "-", convert = TRUE) %>% 
  mutate(month = recode(month, "1" = "January", "2" = "February", "3" = "March", 
                        "4" = "April", "5" = "May", "6" = "June", "7" = "July", 
                        "8" = "August","9" = "September", "10" = "October", 
                        "11" = "November", "12" = "December"))%>%
  mutate(president = recode(.x = prez_dem, '0' = "gop", '1' = "dem"))%>%
  select(-prez_dem, -prez_gop, -day)%>%
  relocate(year, month, president)
view(pols_month_data)
```

## P1-2nd part
```{r}
snpdata = read_csv("./data/snp.csv")%>%
separate(date, into = c("month", "day","year"), sep = "/", convert = TRUE)%>%
mutate(month = recode(month, "1" = "January", "2" = "February", "3" = "March", 
                        "4" = "April", "5" = "May", "6" = "June", "7" = "July", 
                        "8" = "August","9" = "September", "10" = "October", 
                        "11" = "November", "12" = "December"))%>%
mutate(year = as.numeric(year)) %>%
  mutate(year = ifelse(year > 49, year + 1900, year + 2000))%>%
select(-day)%>%
  relocate(year, month)
view(snpdata)
```

## P1-3rd part
```{r}
unemploydata = read_csv("./data/unemployment.csv")%>%
janitor::clean_names()%>%
  pivot_longer(cols = jan:dec,
               names_to = "month",
               values_to = "Percentage_of_unemployment")%>%
mutate(month = recode(month, "jan" = "January", "feb" = "February", 
                      "mar" = "March", "apr" = "April", "may" = "May", "jun" = "June", 
                      "jul" = "July", "aug" = "August", "sep" = "September", 
                      "oct" = "October","nov" = "November", "dec" = "December"))
view(unemploydata)
```

## Binding Data
```{r}
merge_data = left_join(pols_month_data, snpdata,
                       by = c("year", "month"))%>%
  left_join(unemploydata, by = c("year", "month"))%>%
relocate(year, month, president)
view(merge_data)
```

For the first data set "pols_month_data", we have 822 rows and 9 columns. The range for this data set is 1947-2015, which contain important information related to the number of national politicians who are democratic or republican at any given time. The key variable is create a president variable taking values "gop" and "dem". For the second data set "snpdata", we have 787 rows and 2 columns. The range for this data set is 1950-2015, which contain the date of the observation and the closing values of the S&P stock index on the associated date. For the third data set "unemploydata", we have 68 rows and 13 columns. The range for this data set is 1948-2015, which contain the year of the measurements and percentage of unemployment in the particular month of the associated year. The result is that after organizing these data in various ways, such as arranging them by year and month, etc., we can integrate three different excel data for easy viewing.

## Problem 2
```{r}
MrTrashdata = readxl::read_excel("./data/202207 Trash Wheel Collection Data.xlsx",
                                 sheet = "Mr. Trash Wheel",
                                 range = "A2:N549")%>%
  janitor::clean_names()%>%
filter(homes_powered!=0.000)%>%
  drop_na()%>%
  mutate(homes_powered = (weight_tons * 500)/30)
view(MrTrashdata)
```

```{r}
ProTrashdata = readxl::read_excel("./data/202207 Trash Wheel Collection Data.xlsx",
                                 sheet = "Professor Trash Wheel",
                                 range = "A2:M96")%>%
  janitor::clean_names()%>%
  drop_na()%>%
  mutate(homes_powered = (weight_tons * 500)/30)
view(ProTrashdata)
```

```{r}
Gwyndata = readxl::read_excel("./data/202207 Trash Wheel Collection Data.xlsx",
                                 sheet = "Gwynnda Trash Wheel",
                                 range = "A2:K108")%>%
  janitor::clean_names()%>%
  drop_na()%>%
  mutate(homes_powered = (weight_tons * 500)/30)
view(Gwyndata)
```

## Binding data
```{r}
Mr_Trash_Wheel <- MrTrashdata %>%
  mutate(wheel_name = "Mr. Trash Wheel")
Professor_Trash_Wheel <- ProTrashdata %>%
  mutate(wheel_name = "Professor Trash Wheel")
Gwynna_Trash_Wheel <- Gwyndata %>%
  mutate(wheel_name = "Gwynna Trash Wheel")
Mr_Trash_Wheel$year <- as.numeric(Mr_Trash_Wheel$year)
Professor_Trash_Wheel$year <- as.numeric(Professor_Trash_Wheel$year)
Gwynna_Trash_Wheel$year <- as.numeric(Gwynna_Trash_Wheel$year)
combined <- bind_rows(Mr_Trash_Wheel, Professor_Trash_Wheel, Gwynna_Trash_Wheel)
drop_na(combined)
view(combined)
```

The Mr.Trash Wheel key variables are different kind of bags, glass bottles, plastic bottles, and sport balls. For the Professor trash wheel, the key variable are also the same as before but no sport balls. For the Gwynna trash wheel, the variable are also same but without sports balls, chip bags, grocery bags, and glass bottle. The dumpster number, trash weight, and home powered are important for all the trash wheels. The total weight of trash collected by Professor Trash Wheel is 190.12 tons, and the total number of cigarette butts collected by Gwynnda in July of 2021 is 16300.

## Probelm 3
## P3-1st part
```{r}
MCI = read_csv("./data/MCI_baseline.csv", skip = 1)%>%
janitor::clean_names()
MCI$sex <- ifelse(MCI$sex == 1, "Male", "Female")
MCI$apoe4 <- ifelse(MCI$apoe4 == 1, "Apoe4 carrier", "Non-Apeo4 carrier")
MCI <- MCI[MCI$age_at_onset %in% as.numeric(MCI$age_at_onset), ]
view(MCI)
```

First I chose the path to read the document, and used Janitor to modify the name of the document, and I used “skip=1” to skip reading the name of the first line, because that is not what we want. The second line is the title. After this I used “ifelse” to classify files of type 0 and 1 and give the corresponding numbers different names. Then I used “%in%” to filter out rows that were not data in the age on set. And this data includes age, gender, education and whether you are a carrier of apoe4. They are 483 participants were recruited and 97 developed MCI. 

```{r}
x <- mean(MCI$current_age)
print(x)
```
The average age for this MCI is 65.611.

```{r}
count_female = MCI %>% group_by(sex) %>% filter(sex=="Female") %>% summarize(n=n())
count_female
```

The number of MCI female is 46.

```{r}
count_apoe4 = MCI %>% group_by(apoe4) %>% filter(apoe4=="Apoe4 carrier") %>% summarize(n=n())
count_apoe4
```

The number of total apoe4 carrier is 61. So the proportion of women in the study are APOE4 carriers is 46/61 = 0.7541.

## P3-2nd part
```{r}
Amyloid = read_csv("./data/mci_amyloid.csv", skip = 1)%>%
  janitor::clean_names()%>%
  drop_na()
Amyloid <- Amyloid[!grepl("Na", Amyloid$baseline), ]
Amyloid <- Amyloid[!grepl("Na", Amyloid$time_2), ]
Amyloid <- Amyloid[!grepl("Na", Amyloid$time_4), ]
Amyloid <- Amyloid[!grepl("Na", Amyloid$time_6), ]
Amyloid <- Amyloid[!grepl("Na", Amyloid$time_8), ]
view(Amyloid)
```

Same as the previous data, I chose the path to read the document, and used Janitor to modify the name of the document, and I used “skip=1” to skip reading the name of the first line, because that is not what we want. The second line is the title. Then I used drop na to delete the rows with NA, and Na occurred in this data, so I had to eliminate by using !grepl(pattern, x), which is used to filter out elements in the character vector x that do not match the specified pattern. Then the Na in each row is disappeared. This data contains the elapsed time (in years) from study baseline to the visit where the biomarker amyloid 42/40 ratio was measured and four different time points.

## P3-3rd part

